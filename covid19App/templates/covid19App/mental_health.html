{% extends 'covid19App/base.html' %}

{% block title %}COVID19{% endblock title%}

{% block scripts %}
<script>
  var ctx = document.getElementById("mental_healthChart").getContext('2d');

var original = Chart.defaults.global.legend.onClick;
Chart.defaults.global.legend.onClick = function(e, legendItem) {
  update_caption(legendItem);
  original.call(this, e, legendItem);
};

var mental_healthChart = new Chart(ctx, {
  type: 'bar',
  data: {

    labels: [{% for item in mental_healthDepression_qs %}'{{item.state}}', {% endfor %}],

    datasets: [{
      label: 'Symptoms of Depressive Disorder',
      backgroundColor: "rgba(255, 99, 132, 0.2)",
      borderColor: "rgba(255, 99, 132, .3)",
      borderWidth: 1,
      data: [{% for item in mental_healthDepression_qs %}'{{item.value}}', {% endfor %}],
    }, {
      label: 'Symptoms of Anxiety Disorder',
      backgroundColor: "rgba(255, 206, 86, 0.3)",
      borderColor: "rgba(255, 206, 86, .5)",
      borderWidth: 1,
      data: [{% for item in mental_healthAnxiety_qs %}'{{item.value}}', {% endfor %}],
    }
    ]

  }
});

var labels = {
  "Depression Disorder": true,
  "Anxiety Disorder": true,
};

var caption = document.getElementById("caption");

var update_caption = function(legend) {
  labels[legend.text] = legend.hidden;

  var selected = Object.keys(labels).filter(function(key) {
    return labels[key];
  });

  var text = selected.length ? selected.join(" & ") : "nothing";

  caption.innerHTML = "The chart is displaying ??? of Symptoms of " + text;
};
</script>
{% endblock scripts %}

{% block content %}

<h1>IMPACT ON Mental Health</h1>
<canvas id="mental_healthChart" width="400" height="180"></canvas>
<p id="caption">The chart is displaying ??? of Symptoms of Depression Disorder and Anxiety Disorder.</p>
{% endblock content %}