{% extends 'covid19App/base.html' %}

{% block title %}COVID19{% endblock title%}

{% block scripts %}
<!-- <script>
  $(document).ready(function () {
    var ctx = document.getElementById('myChart').getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [{% for item in qs %}'{{item.country}}', {% endfor %}],
        datasets: [{
          label: '2019',
          data: [{% for item in qs %}'{{item.gdp}}', {% endfor %}],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)',
            'rgba(75, 192, 192, 0.2)',
            'rgba(153, 102, 255, 0.2)',
            'rgba(255, 159, 64, 0.2)'
          ],
          borderColor: [
            'rgba(255, 99, 132, 1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)',
            'rgba(75, 192, 192, 1)',
            'rgba(153, 102, 255, 1)',
            'rgba(255, 159, 64, 1)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        }
      }
    });
  })
</script>-->

<script>
  var ctx = document.getElementById("myChart").getContext('2d');

var original = Chart.defaults.global.legend.onClick;
Chart.defaults.global.legend.onClick = function(e, legendItem) {
  update_caption(legendItem);
  original.call(this, e, legendItem);
};

var myChart = new Chart(ctx, {
  type: 'bar',
  data: {

    labels: [{% for item in qs %}'{{item.country}}', {% endfor %}],

    datasets: [{
      label: '2019',
      backgroundColor: "rgba(255, 99, 132, 0.2)",
      borderColor: "rgba(255, 99, 132, .3)",
      borderWidth: 1,
      data: [{% for item in qs %}'{{item.gdp}}', {% endfor %}],
    }, {
      label: '2020',
      backgroundColor: "rgba(255, 206, 86, 0.3)",
      borderColor: "rgba(255, 206, 86, .5)",
      borderWidth: 1,
      data: [{% for item in economy20_qs %}'{{item.gdp20}}', {% endfor %}],
    }, {
      label: '2021',
      backgroundColor: "rgba(75, 192, 192, 0.3)",
      borderColor: "rgba(75, 192, 192, .5)",
      borderWidth: 1,
      data: [{% for item in economy21_qs %}'{{item.gdp21}}', {% endfor %}],}
    ]

  }
});

var labels = {
  "2019": true,
  "2020": true,
  "2021": true,
};

var caption = document.getElementById("caption");

var update_caption = function(legend) {
  labels[legend.text] = legend.hidden;

  var selected = Object.keys(labels).filter(function(key) {
    return labels[key];
  });

  var text = selected.length ? selected.join(" & ") : "nothing";

  caption.innerHTML = "The chart is displaying GDP in percentage of " + text;
};
</script>

{% endblock scripts %}

{% block content %}

<h1>ECONOMIC IMPACT</h1>
<canvas id="myChart" width="400" height="180"></canvas>

<p id="caption">The chart is displaying GDP in percentage of 2019, 2020 and 2021.</p>
{% endblock content %}